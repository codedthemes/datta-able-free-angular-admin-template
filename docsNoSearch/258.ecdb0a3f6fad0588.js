"use strict";(self.webpackChunkdatta_able_free_angular_admin_template=self.webpackChunkdatta_able_free_angular_admin_template||[]).push([[258],{5258:(J,g,i)=>{i.r(g),i.d(g,{RewardsTypesModule:()=>P});var c=i(177),R=i(8834),b=i(3719),j=i(9631),T=i(4823),o=i(9417),e=i(3953),$=i(1626),C=i(1441);let F=(()=>{class s{constructor(t,a){this.http=t,this.appConfig=a,this.url=this.appConfig.defaultUrl}AddReward(t){return this.http.post(`${this.url}/api/Reward/AddReward?culture=ar-LY`,t)}UpdateReward(t){return this.http.put(`${this.url}/api/Reward/UpdateReward?culture=ar-LY`,t)}DeleteReward(t){return this.http.delete(`${this.url}/api/Reward/DeleteReward?Id=${t}&culture=ar-LY`)}GetRewards(t){return this.http.get(`${this.url}/api/Reward/GetRewards?IsActive=${t}&culture=ar-LY`)}static#e=this.\u0275fac=function(a){return new(a||s)(e.KVO($.Qq),e.KVO(C.o))};static#t=this.\u0275prov=e.jDH({token:s,factory:s.\u0275fac})}return s})();var V=i(9183),I=i(1786),S=i(4412),p=i(6496),h=i(8141),l=i(3471),w=i(1025),k=i(3197);let f=(()=>{class s{constructor(t,a){this.sharedFacade=t,this.rewardsTypesServices=a,this.RewardsSubject$=new S.t([]),this.Rewards$=this.RewardsSubject$.asObservable()}deleteReward(t){const a=this.rewardsTypesServices.DeleteReward(t).pipe((0,h.M)(r=>{if(r.type==l.yl.Success){this.sharedFacade.showMessage(l.Go.success," \u062d\u0630\u0641 \u0645\u0643\u0627\u0641\u0623\u0629",["\u062a\u0645 \u062d\u0630\u0641 \u0628\u0646\u062c\u0627\u062d"]);const u=this.RewardsSubject$.getValue().filter(m=>m.id!=t);this.RewardsSubject$.next(u),this.RewardsSubject$.subscribe()}else this.sharedFacade.showMessage(l.Go.error,"\u0644\u0645 \u062a\u062a\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u062d\u0630\u0641",r.messages)}),(0,p.t)());this.sharedFacade.showLoaderUntilCompleted(a).pipe().subscribe()}GetRewards(){const t=this.rewardsTypesServices.GetRewards(1).pipe((0,h.M)(a=>{a.type==l.yl.Success?this.RewardsSubject$.next(a.content):(this.RewardsSubject$.next([]),this.sharedFacade.showMessage(l.Go.error,"\u062e\u0637\u0623 \u0641\u064a \u0639\u0645\u0644\u064a\u0629 \u062c\u0644\u0628 \u0645\u0643\u0627\u0641\u0623\u062a",a.messages))}),(0,p.t)());this.sharedFacade.showLoaderUntilCompleted(t).pipe().subscribe()}AddReward(t){const a=this.rewardsTypesServices.AddReward(t).pipe((0,h.M)(r=>{if(r.type==l.yl.Success){this.sharedFacade.showMessage(l.Go.success,"\u062a\u0645\u062a \u0627\u0644\u0625\u0636\u0627\u0641\u0629 \u0628\u0646\u062c\u0627\u062d",r.messages);const n=this.RewardsSubject$.getValue();this.RewardsSubject$.next((0,w.jM)(n,u=>{t.id=r.content,u.unshift(t)}))}else this.sharedFacade.showMessage(l.Go.error,"\u0644\u0645 \u062a\u062a\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u0625\u0636\u0627\u0641\u0629",r.messages)}),(0,p.t)());this.sharedFacade.showLoaderUntilCompleted(a).pipe().subscribe()}UpdateReward(t){const a=this.rewardsTypesServices.UpdateReward(t).pipe((0,h.M)(r=>{if(r.type==l.yl.Success){this.sharedFacade.showMessage(l.Go.success,"\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u0646\u062c\u0627\u062d",r.messages);const n=this.RewardsSubject$.getValue();this.RewardsSubject$.next((0,w.jM)(n,u=>{const m=u.findIndex(X=>X.id===t.id);u[m]=t})),this.RewardsSubject$.subscribe()}else this.sharedFacade.showMessage(l.Go.error,"\u0644\u0645 \u062a\u062a\u0645 \u0639\u0645\u0644\u064a\u0629 \u062a\u0639\u062f\u064a\u0644",r.messages)}),(0,p.t)());this.sharedFacade.showLoaderUntilCompleted(a).pipe().subscribe()}static#e=this.\u0275fac=function(a){return new(a||s)(e.KVO(k.I),e.KVO(F))};static#t=this.\u0275prov=e.jDH({token:s,factory:s.\u0275fac})}return s})();var v=i(7062);let G=[{value:1,label:"\u0645\u0643\u0627\u0641\u0623\u0629 \u062e\u0627\u0636\u0639\u0629 \u0644\u0636\u0631\u064a\u0628\u0629 \u0627\u0644\u062c\u0647\u0627\u062f"},{value:2,label:"\u0645\u0643\u0627\u0641\u0623\u0629 \u062e\u0627\u0636\u0639\u0629 \u0644\u0643\u0627\u0641\u0629 \u0627\u0644\u0636\u0631\u0627\u0626\u0628"},{value:3,label:"\u0645\u0643\u0627\u0641\u0623\u0629 \u063a\u064a\u0631 \u062e\u0627\u0636\u0639\u0629 \u0644\u0623\u064a \u0636\u0631\u064a\u0628\u0629"}],E=[{value:1,label:"\u0642\u064a\u0645\u0629 \u0645\u062a\u063a\u064a\u0631\u0629"},{value:2,label:"\u0642\u064a\u0645\u0629 \u062b\u0627\u0628\u062a\u0629"},{value:3,label:"\u0646\u0633\u0628\u0629"}];var N=i(2016),A=i(2702),y=i(9947);function D(s,d){if(1&s&&(e.j41(0,"option",22),e.EFF(1),e.k0s()),2&s){const t=d.$implicit;e.Y8G("value",t.value),e.R7$(),e.SpI("",t.label," ")}}function M(s,d){if(1&s&&(e.j41(0,"option",22),e.EFF(1),e.k0s()),2&s){const t=d.$implicit;e.Y8G("value",t.value),e.R7$(),e.SpI("",t.label," ")}}function Y(s,d){1&s&&(e.j41(0,"div",6)(1,"label",23),e.EFF(2,"\u0627\u0644\u0642\u064a\u0645\u0629"),e.k0s(),e.nrm(3,"input",24),e.k0s())}function U(s,d){1&s&&(e.j41(0,"div",6)(1,"label",25),e.EFF(2,"\u0627\u0644\u0646\u0633\u0628\u0629"),e.k0s(),e.nrm(3,"input",26),e.k0s())}function x(s,d){if(1&s){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td",27)(8,"a",28),e.bIt("click",function(){const r=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.onEdit(r))}),e.j41(9,"i",29),e.EFF(10,"edit"),e.k0s()(),e.j41(11,"a",30),e.bIt("click",function(){const r=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.onDelete(r.id))}),e.j41(12,"i",31),e.EFF(13,"close"),e.k0s()()()()}if(2&s){const t=d.$implicit;e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.rewardTypeName),e.R7$(2),e.JRh(t.calculatingRewardValueName)}}const O=[{path:"",component:(()=>{class s{constructor(t,a,r){this.fb=t,this.rewardsTypesFacade=a,this.cdr=r,this.edit=!1,this.registerForm=this.fb.group({id:[""],calculatingRewardValueName:[""],rewardTypeName:[""],name:["",o.k0.required],rewardTypeId:[0,o.k0.required],calculatingRewardValueId:[0,o.k0.required],value:[0,o.k0.required],percentage:[0,o.k0.required]}),this.optionsRewardType=G,this.optionsCalculatingReward=E,this.onSubmit()}ngOnInit(){this.edit=!1}ngOnDestroy(){}onSubmit(){this.registerForm.controls.id.setValue(""),this.rewardsTypesFacade.GetRewards()}onDelete(t){this.edit=!1,this.rewardsTypesFacade.deleteReward(t),this.registerForm.reset()}onReset(){this.edit=!1,this.registerForm.reset(),this.registerForm.setErrors(null)}resetCalculatingReward(){this.registerForm.controls.value.setValue(0),this.registerForm.controls.percentage.setValue(0)}onAdd(){this.registerForm.controls.value.setValidators(2==this.registerForm.value.calculatingRewardValueId?o.k0.required:null),this.registerForm.controls.percentage.setValidators(3==this.registerForm.value.calculatingRewardValueId?o.k0.required:null),this.registerForm.value.rewardTypeName=this.optionsRewardType.find(t=>t.value==this.registerForm.value.rewardTypeId)?.label,this.registerForm.value.calculatingRewardValueName=this.optionsCalculatingReward.find(t=>t.value==this.registerForm.value.calculatingRewardValueId)?.label,this.registerForm.valid&&(this.edit?(this.rewardsTypesFacade.UpdateReward(this.registerForm?.value),this.onReset()):(this.rewardsTypesFacade.AddReward(this.registerForm?.value),this.onReset()))}onEdit(t){this.registerForm.patchValue(t),this.registerForm.value.rewardTypeName=this.optionsRewardType.find(a=>a.value==this.registerForm.value.rewardTypeId)?.label,this.registerForm.value.calculatingRewardValueName=this.optionsCalculatingReward.find(a=>a.value==this.registerForm.value.calculatingRewardValueId)?.label,this.edit=!0}static#e=this.\u0275fac=function(a){return new(a||s)(e.rXU(o.ok),e.rXU(f),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["app-rewards-types"]],decls:48,vars:9,consts:[["calculatingRewardValueId",""],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-body"],["action","javascript:",1,"row","g-3","align-items-center",3,"formGroup"],[1,"col-md-3"],["for","inlineFormInputName"],["type","text","required","","formControlName","name","id","inlineFormInputName",1,"form-control"],["formControlName","rewardTypeId","required","","aria-label","select example",1,"form-select"],["value","","selected","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","calculatingRewardValueId","required","","aria-label","select example",1,"form-select",3,"change"],["class","col-md-3",4,"ngIf"],[1,"col-12"],["type","button",1,"btn","btn-md","btn-themeAdd","has-ripple",3,"click"],["type","button",1,"btn","btn-md","btn-themeNew","has-ripple",3,"click"],[1,"col-xl-12"],["cardTitle","\u0627\u0644\u0645\u0643\u0627\u0641\u0623\u062a","blockClass","table-border-style",3,"options"],[1,"table-responsive"],[1,"table","table-striped","table-hover"],[4,"ngFor","ngForOf"],[3,"value"],["for","inlineFormInputValue"],["type","text","required","","formControlName","value","id","inlineFormInputValue",1,"form-control"],["for","inlineFormInputPercentage"],["type","text","required","","formControlName","percentage","id","inlineFormInputPercentage",1,"form-control"],[1,"td-actions"],["mat-button","","type","button","aria-hidden","true","data-notify","dismiss",1,"edit","mat-button",3,"click"],[1,"material-icons","text-warning"],["mat-button","","type","button","aria-hidden","true","data-notify","dismiss",1,"close","mat-button",3,"click"],[1,"material-icons","text-danger"]],template:function(a,r){if(1&a){const n=e.RV6();e.j41(0,"div",1),e.nrm(1,"app-loading")(2,"app-messages"),e.j41(3,"div",2)(4,"div",3)(5,"div",4)(6,"form",5)(7,"div",6)(8,"label",7),e.EFF(9,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0643\u0627\u0641\u0623\u0629"),e.k0s(),e.nrm(10,"input",8),e.k0s(),e.j41(11,"div",6)(12,"label"),e.EFF(13,"\u0646\u0648\u0639 \u0627\u0644\u0645\u0643\u0627\u0641\u0623\u0629"),e.k0s(),e.j41(14,"select",9)(15,"option",10),e.EFF(16,"\u0627\u062e\u062a\u0631 ..."),e.k0s(),e.DNE(17,D,2,2,"option",11),e.k0s()(),e.j41(18,"div",6)(19,"label"),e.EFF(20,"\u0622\u0644\u064a\u0629 \u0627\u062d\u062a\u0633\u0627\u0628 \u0642\u064a\u0645\u0629 \u0627\u0644\u0645\u0643\u0627\u0641\u0623\u0629"),e.k0s(),e.j41(21,"select",12,0),e.bIt("change",function(){return e.eBV(n),e.Njj(r.resetCalculatingReward())}),e.j41(23,"option",10),e.EFF(24,"\u0627\u062e\u062a\u0631 ..."),e.k0s(),e.DNE(25,M,2,2,"option",11),e.k0s()(),e.DNE(26,Y,4,0,"div",13)(27,U,4,0,"div",13),e.j41(28,"div",14)(29,"button",15),e.bIt("click",function(){return e.eBV(n),e.Njj(r.onAdd())}),e.EFF(30,"\u062d\u0641\u0638"),e.k0s(),e.j41(31,"button",16),e.bIt("click",function(){return e.eBV(n),e.Njj(r.onReset())}),e.EFF(32,"\u062c\u062f\u064a\u062f"),e.k0s()()()()()(),e.j41(33,"div",17)(34,"app-card",18)(35,"div",19)(36,"table",20)(37,"thead")(38,"th"),e.EFF(39,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0643\u0627\u0641\u0623\u0629"),e.k0s(),e.j41(40,"th"),e.EFF(41,"\u0646\u0648\u0639 \u0627\u0644\u0645\u0643\u0627\u0641\u0623\u0629"),e.k0s(),e.j41(42,"th"),e.EFF(43,"\u0622\u0644\u064a\u0629 \u0627\u0644\u0625\u062d\u062a\u0633\u0627\u0628"),e.k0s(),e.nrm(44,"th"),e.k0s(),e.j41(45,"tbody"),e.DNE(46,x,14,3,"tr",21),e.nI1(47,"async"),e.k0s()()()()()()}if(2&a){const n=e.sdS(22);e.R7$(6),e.Y8G("formGroup",r.registerForm),e.R7$(11),e.Y8G("ngForOf",r.optionsRewardType),e.R7$(8),e.Y8G("ngForOf",r.optionsCalculatingReward),e.R7$(),e.Y8G("ngIf","2"==n.value.toString()),e.R7$(),e.Y8G("ngIf","3"==n.value.toString()),e.R7$(7),e.Y8G("options",!1),e.R7$(12),e.Y8G("ngForOf",e.bMT(47,7,r.rewardsTypesFacade.Rewards$))}},dependencies:[c.Sq,c.bT,R.It,o.qT,o.xH,o.y7,o.me,o.wz,o.BC,o.cb,o.YS,o.j4,o.JD,N.q,A.y,y.i,c.Jj]})}return s})(),data:{breadcrumb:"\u0627\u0646\u0648\u0627\u0639 \u0627\u0644\u0645\u0643\u0627\u0641\u0623\u062a"}}];let B=(()=>{class s{static#e=this.\u0275fac=function(a){return new(a||s)};static#t=this.\u0275mod=e.$C({type:s});static#s=this.\u0275inj=e.G2t({imports:[v.iI.forChild(O),v.iI]})}return s})();var L=i(2798);let P=(()=>{class s{static#e=this.\u0275fac=function(a){return new(a||s)};static#t=this.\u0275mod=e.$C({type:s});static#s=this.\u0275inj=e.G2t({providers:[f,F],imports:[c.MD,R.Hl,b.RG,j.fS,T.uc,o.X1,B,V.D6,I.G,o.YN,L.Ve,y.i]})}return s})()}}]);
